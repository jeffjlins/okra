openapi: 3.0.3
info:
  title: Okra API
  description: |
    REST API for the Okra application with Firestore integration.
    
    This API provides endpoints for health checks, demo data operations, and more.
  version: 1.0.0
  contact:
    name: API Support
    email: support@example.com
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT

servers:
  - url: http://localhost:8080
    description: Local development server
  - url: https://api.example.com
    description: Production server

tags:
  - name: Health
    description: Health check endpoints
  - name: Demo
    description: Demo data operations

paths:
  /health:
    get:
      tags:
        - Health
      summary: Health check
      description: Returns the health status of the API
      operationId: getHealth
      responses:
        '200':
          description: Service is healthy
          content:
            text/plain:
              schema:
                type: string
                example: ok

  /hello:
    get:
      tags:
        - Health
      summary: Hello world
      description: Returns a hello world message
      operationId: getHello
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HelloResponse'
              example:
                message: "hello, world"

  /demo:
    post:
      tags:
        - Demo
      summary: Create demo document
      description: Creates a new demo document in Firestore with the provided fields
      operationId: createDemo
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DemoRequest'
            examples:
              example1:
                summary: Example request
                value:
                  field1: "value1"
                  field2: "value2"
      responses:
        '201':
          description: Demo document created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DemoResponse'
              example:
                id: "abc123xyz"
                field1: "value1"
                field2: "value2"
        '400':
          description: Bad request - invalid input
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                invalidJson:
                  summary: Invalid JSON
                  value:
                    error: "Invalid JSON: unexpected EOF"
                missingFields:
                  summary: Missing required fields
                  value:
                    error: "Both field1 and field2 are required"
        '405':
          description: Method not allowed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                error: "Failed to save data"

components:
  schemas:
    HelloResponse:
      type: object
      required:
        - message
      properties:
        message:
          type: string
          description: Hello message
          example: "hello, world"

    DemoRequest:
      type: object
      required:
        - field1
        - field2
      properties:
        field1:
          type: string
          description: First field value
          example: "value1"
        field2:
          type: string
          description: Second field value
          example: "value2"

    DemoResponse:
      type: object
      required:
        - id
        - field1
        - field2
      properties:
        id:
          type: string
          description: Auto-generated document ID from Firestore
          example: "abc123xyz"
        field1:
          type: string
          description: First field value
          example: "value1"
        field2:
          type: string
          description: Second field value
          example: "value2"

    Error:
      type: object
      required:
        - error
      properties:
        error:
          type: string
          description: Error message
          example: "An error occurred"

